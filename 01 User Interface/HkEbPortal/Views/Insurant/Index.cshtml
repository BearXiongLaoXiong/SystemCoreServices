@using HkEbPortal.Models.EB_PORTAL
@model IEnumerable<SPEH_FMDT_FAMILY_DETL_LIST_WEB_RESULT>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Scripts/css/layui.css" rel="stylesheet" />
<div class="container">
    
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
        <legend i18n="Insurant.index.info">被保险人信息</legend>
    </fieldset>
    
    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 20px;">
        <span i18n="Insurant.index.gpgpinfo">团体名称</span>: @ViewData["GPGPName"]
    </blockquote>

    <div class="layui-tab layui-tab-card" lay-filter="docDemoTabBrief" style="min-height:600px;max-height:100%;">
        <ul class="layui-tab-title">
            <li class="layui-this" i18n="Insurant.index.memeber">员工信息</li>
            <li i18n="Insurant.index.family">家庭成员</li>
            <li i18n="Insurant.index.policyInfo">保单信息</li>
            <li i18n="Insurant.index.billingInformation">账单信息</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show"> 
                <table class="layui-table" lay-skin="line">
                    <thead>
                        <tr>
                            <th hidden>KEY</th>
                            <th i18n="Insurant.table1.employeestartdate">员工起始日</th>
                            <th i18n="Insurant.table1.employeeenddate">员工终止日</th>
                            <th i18n="Insurant.table1.employeemonthly">员工月薪(￥)</th>
                            <th i18n="Insurant.table1.employeestaffdep">员工部门</th>
                            <th i18n="Insurant.table1.employeelevel">员工等级</th>
                            <th i18n="Insurant.table1.employeestaffpositions">员工职务</th>
                            <th i18n="Insurant.table1.employeecomment">说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td hidden>@item.FMFM_KY</td>
                                <td>@item.FMDT_EFF_DT</td>
                                <td>@item.FMDT_TERM_DT</td>
                                <td>@item.FMFM_ANNUAL_SALARY</td>
                                <td>@item.FMFM_DEPT</td>
                                <td>@item.GCGC_DESC</td>
                                <td>@item.FMFM_POSITION</td>
                                <td>@item.FMDT_COMMENT</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="layui-tab-item"> 
                <table class="layui-table" lay-skin="line">
                    <thead>
                        <tr>
                            <th hidden>KEY</th>
                            <th i18n="Insurant.table2.Relationship">关系</th>
                            <th i18n="Insurant.table2.Name">姓名</th>
                            <th i18n="Insurant.table2.IDnumber">证件号</th>
                            <th i18n="Insurant.table2.Gender">性别</th>
                            <th i18n="Insurant.table2.Birthday">生日</th>
                            <th i18n="Insurant.table2.Phone">手机</th>
                            <th i18n="Insurant.table2.Email">电子邮件</th>
                            <th i18n="Insurant.table2.Zipcode">邮政编码</th>
                        </tr>
                    </thead>
                    <tbody id="familyId"></tbody>
                </table>
            </div>
            <div class="layui-tab-item">
                <table class="layui-table" lay-skin="line">
                    <thead>
                        <tr>
                            <th hidden>KEY</th>
                            <th i18n="Insurant.table3.policystatus">保单状态</th>
                            <th i18n="Insurant.table3.startdate">生效日</th>
                            <th i18n="Insurant.table3.enddate">终止日</th>
                            <th i18n="Insurant.table3.memename">被保险人</th>
                            <th i18n="Insurant.table3.relationship">关系</th>
                            <th i18n="Insurant.table3.idnumber">证件号</th>
                            <th i18n="Insurant.table3.numberprefix">证件号前缀</th>
                            <th i18n="Insurant.table3.type">类型</th>
                        </tr>
                    </thead>
                    <tbody id="policyInfoId"></tbody>
                </table>
            </div> 
            <div class="layui-tab-item"> 
                <table class="layui-table" lay-skin="nob">
                    <thead>
                        <tr>
                            <th hidden>key</th>
                            <th i18n="Insurant.table4.BillingDate">账单日期</th>
                            <th i18n="Insurant.table4.Billingtype">账单类型</th>
                            <th i18n="Insurant.table4.CurrentAmount">当前金额(￥)</th>
                            <th i18n="Insurant.table4.Bill">账单</th>
                            <th i18n="Insurant.table4.Comment">备 注</th>
                        </tr>
                    </thead>
                    <tbody id="BillingInformationId"></tbody>
                </table>
            </div> 
         </div>
    </div> 
</div>
<script src="~/Scripts/layui.js"></script>
<script>
    layui.use('element', function () {
        var $ = layui.jquery,element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

        $('.site-demo-active').on('click', function () {
            var othis = $(this), type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });
    });

    $(function () {
        $.ajax({
            type: 'POST',
            url: "/Insurant/GetFamilyInfo",
            data: "",
            dataType: "json",
            success: function (data, status) {
                var familyStr = "";
                $.each(data, function (i, row) {
                    familyStr += "<tr>";
                    familyStr += "<td hidden>" + row.FMFM_KY + "</td>";
                    familyStr += "<td>" + row.SYSV_MEME_REL_CD_DESC + "</td>";
                    familyStr += "<td>" + row.MEME_NAME + "</td>";
                    familyStr += "<td>" + row.MEME_CERT_ID_NUM + "</td>";
                    familyStr += "<td>" + row.SYSV_SEX_DESC + "</td>";
                    familyStr += "<td>" + row.MEME_BIRTH_DT + "</td>";
                    familyStr += "<td>" + row.MEME_HOM_PHONE + "</td>";
                    familyStr += "<td>" + row.MEME_EMAIL + "</td>";
                    familyStr += "<td>" + row.MEME_ZIP + "</td>";
                    familyStr += "</tr>";
                });

                $("#familyId").html(familyStr);
            }
        });

        $.ajax({
            type: 'POST',
            url: "/Insurant/GetPolicyInfo",
            data: "",
            dataType: "json",
            success: function (dat, status) {
                var policyInfoStr = "";
                $.each(dat, function (i,row) {
                    policyInfoStr += "<tr>";
                    policyInfoStr += "<td hidden>" + row.PLPL_ID + "</td>";
                    policyInfoStr += "<td>" + row.SYSV_PLPL_STS + "</td>";
                    policyInfoStr += "<td>" + row.PLME_STR_DT + "</td>";
                    policyInfoStr += "<td>" + row.PLPL_END_DT + "</td>";
                    policyInfoStr += "<td>" + row.MEME_NAME + "</td>";
                    policyInfoStr += "<td>" + row.SYSV_MEME_REL_CD + "</td>";
                    policyInfoStr += "<td>" + row.Cert_No + "</td>";
                    policyInfoStr += "<td>" + row.Cert_Prefix + "</td>";
                    policyInfoStr += "<td>" + row.CLASS + "</td>";
                    policyInfoStr += "</tr>";
                });
                $("#policyInfoId").html(policyInfoStr)
            }
        });



        $.ajax({
            type: 'POST',
            url: "/Insurant/GetBillingInfomation",
            data: "",
            dataType: "json",
            success: function (dat, status) {
                var billingInfoStr = "";
                $.each(dat, function (i, row) {
                    billingInfoStr += "<tr>";
                    billingInfoStr += "<td hidden>" + row.FMAC_KY + "</td>";
                    billingInfoStr += "<td>" + row.FMAC_DTM + "</td>";
                    billingInfoStr += "<td>" + row.POST_TYPE_DESC + "</td>";
                    billingInfoStr += "<td>" + row.FMFM_CUR_AMT + "</td>";
                    billingInfoStr += "<td>" + row.SYSV_BILL_FREQ_DESC + "</td>";
                    billingInfoStr += "<td>" + row.COMMENT + "</td>";
                    billingInfoStr += "</tr>";
                });
                $("#BillingInformationId").html(billingInfoStr);
            }
        });
    });
</script>